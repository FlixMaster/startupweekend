
<!DOCTYPE html>
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width" />
<title>FlixMaster API Demo -- Basho Goes to Lunch</title>
<style type="text/css">@import url(styles.css);</style>
<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.8.2/jquery.min.js" type="text/javascript"></script>
<script src="http://cdn1.flixmaster.com/api/v1.js" type="text/javascript"></script>
<script type="text/javascript">
	function enter(location){
		var image = "#eee";
		if(location == "atlas"){
			image = 'url(images/cake.jpg)';
		}else if(location == "mcdevitt"){
			image = 'url(images/beers.jpg)';
		}
		$("#content").css({
			'background-image': image,
			'background-size': '100%'
		});
	}
$(function(){
	function explode($o){
		$o.css("position", "relative");
		$o.css({position: "relative",
			opacity: 1,
			fontSize: 12,
			top: 0,
			left: 0
		}).animate({
			opacity: 0,
			fontSize: 84
			//top: newTop,
			//left:newLeft
	    },1000,function(){ this.remove(); });
	}

	function reset_adventure(){
		$("#inventory").empty();
		$("#items").find(".empty").clone(false).appendTo("#inventory");
	}

	function remove_empty_message(){
		// inventory isn't empty anymore
		$("#inventory").find(".empty").remove();		
	}

	function receive_item(item){
		remove_empty_message();
		// clone taco element into inventory
		$("#items").find("."+item).clone(false).appendTo("#inventory");
		$("#inventory").append("<span>Received item!</span>");
		explode($("#inventory").find("span"));
		//$("#inventory").find("span").remove();
	}


	flixmaster_init(function(e){
		var action = e.action, event = e.event;
		console.log(action);
		if(event == "flixmaster_button_click"){
			console.log(action); // The action payload. Will be the string from the Node Editor
		} else if(event == "flixmaster_attention") {
			console.log(action.progress); // Percentage progress (0, 25, 50, 75, 98)
			console.log(action.clipname); // Name of the media clip in the Node firing the event
			console.log(action.time); // Current playback time in seconds

			// if... "Chatter.com-_Halftime_Ad_1_with_will.i.am.mp4"
			if(action.progress == 0){
				reset_adventure();
			}else if(action.progress == 25){
				receive_item("taco");
			}else if(action.progress == 50){
				receive_item("mate");
			}else if(action.progress == 75){
				receive_item("coupon");
			}
		}
	});
	reset_adventure();
});
</script>
</head>
<body>
<div id="header">
	<h1><a href="http://www.flixmaster.com"><img src="images/logo.png" alt="FlixMaster" /> <small>www.flixmaster.com</small></a></h1>
</div>

<div id="intro">
	<div class="inner">
		<h1>Basho Goes to Lunch</h1>
		<h2>A simple demonstration of a FlixMaster project with some basic Player API interactions.</h2>
	</div>
</div>

<div id="content">
	<div class="inner group">
		<div id="fm_container">
			<iframe src="http://cdn1.flixmaster.com/projects/2962/embed?autoplay=true" width="720" height="445" scrolling="no" frameborder="0" marginheight="0" marginwidth="0">
				<p style="text-align:center">Iframes are required to view this content.</p>
			</iframe>
		</div>
		<div id="inventory-wrapper">
			<div>
				<h3>Basho's Inventory:</h3>
				<ul id="inventory">
					<li><p>Empty handed!<p></li>
				</ul>
			</div>
		</div>
	</div>
	<ul id="items" style="display:none;">
		<li class="empty">
			<p>Empty handed!<p>
		</li>
		<li class="taco">
			<p>Fancy taco icon!</p>
		</li>
		<li class="mate">
			<p>Fancy mate drink!</p>
		</li>
		<li class="coupon">
			<p>Coupon with link to downloadable pdf</p>
		</li>
	</ul>
</div>
</body>
</html>
